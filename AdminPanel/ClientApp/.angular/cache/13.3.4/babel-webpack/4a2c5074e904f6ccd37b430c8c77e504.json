{"ast":null,"code":"import { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { ImageUploadComponent } from '../../_directives/image-upload/image-upload.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/service/localstorage.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/service/category.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../_directives/image-upload/image-upload.component\";\n\nfunction AddCategoryComponent_div_53_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"div\", 12);\n    i0.ɵɵelement(2, \"br\");\n    i0.ɵɵelementStart(3, \"div\", 35)(4, \"div\", 36)(5, \"h1\", 13);\n    i0.ɵɵtext(6, \"Item photos\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 37)(8, \"a\", 38);\n    i0.ɵɵlistener(\"click\", function AddCategoryComponent_div_53_Template_a_click_8_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return ctx_r1.deleteImage();\n    });\n    i0.ɵɵtext(9, \"Delete\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(10, \"div\", 39)(11, \"div\", 40)(12, \"div\", 41)(13, \"div\", 42);\n    i0.ɵɵelement(14, \"img\", 43);\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"src\", ctx_r0.f.image.value, i0.ɵɵsanitizeUrl);\n  }\n}\n\nconst _c0 = function () {\n  return [\"/admin/products/category\"];\n};\n\nexport let AddCategoryComponent = /*#__PURE__*/(() => {\n  class AddCategoryComponent {\n    constructor(formBuilder, ls, router, route, categoryService) {\n      this.formBuilder = formBuilder;\n      this.ls = ls;\n      this.router = router;\n      this.route = route;\n      this.categoryService = categoryService;\n      this.submitted = false;\n      this.addCategory = FormGroup;\n      this.today = new Date();\n      this.progressInfos = [];\n      this.message = [];\n      this.selectedStatus = '';\n      this.previews = [];\n      this.createForm();\n    }\n\n    createForm() {\n      this.addCategory = this.formBuilder.group({\n        name: new FormControl('', [Validators.required]),\n        rowID: 0,\n        alternateName: new FormControl(''),\n        description: new FormControl(''),\n        statusID: new FormControl(''),\n        displayOrder: new FormControl(''),\n        categoryID: 0,\n        image: new FormControl(''),\n        locationID: this.ls.getSelectedLocation().locationID,\n        LastUpdatedBy: this.ls.getSelectedUser().userName\n      });\n    }\n\n    editForm(obj) {\n      console.log(obj);\n      this.f.name.setValue(obj.name);\n      this.f.alternateName.setValue(obj.alternateName);\n      this.f.displayOrder.setValue(obj.displayOrder);\n      this.f.categoryID.setValue(obj.categoryID);\n      this.f.image.setValue(obj.image);\n      this.f.description.setValue(obj.description);\n      this.f.statusID.setValue(obj.statusID === 1 ? 1 : 2);\n      this.f.locationID.setValue(this.ls.getSelectedLocation().locationID);\n      this.f.LastUpdatedBy.setValue(this.ls.getSelectedUser().userName);\n      this.f.rowID.setValue(obj.rowID);\n    }\n\n    deleteImage() {\n      if (this.f.image.value) {\n        this.f.image.value = \"\"; // this.selectedFiles = !this.selectedFiles ? this.FilesSeleced : null;\n\n        console.log(this.imgComp);\n      }\n    }\n\n    selectFiles(event) {\n      this.message = [];\n      this.progressInfos = [];\n      this.selectedFiles = event.target.files;\n      this.previews = [];\n\n      if (this.selectedFiles && this.selectedFiles[0]) {\n        const numberOfFiles = this.selectedFiles.length;\n\n        for (let i = 0; i < numberOfFiles; i++) {\n          const reader = new FileReader();\n\n          reader.onload = e => {\n            this.previews.push(e.target.result);\n          };\n\n          reader.readAsDataURL(this.selectedFiles[i]);\n        }\n      }\n    }\n\n    setSelectedCategory() {\n      this.route.paramMap.subscribe(param => {\n        const scid = +param.get('id');\n\n        if (scid) {\n          //this.loadingCategory = true;\n          this.f.categoryID.setValue(scid);\n          this.categoryService.getById(scid).subscribe(response => {\n            //   //Set Forms\n            this.editForm(response); //   //this.loadingCategory = false;\n          });\n        }\n      });\n    }\n\n    onSubmit() {\n      debugger;\n      this.addCategory.markAllAsTouched();\n      this.submitted = true;\n\n      if (this.addCategory.invalid) {\n        return;\n      } // this.f.statusID.setValue(this.f.statusID.value === \"Active\" ? 1 : 2);\n\n\n      this.f.image.setValue(this.imgComp.imageUrl);\n\n      if (parseInt(this.f.categoryID.value) === 0) {\n        delete this.f.categoryID;\n        this.categoryService.AddCategory(this.addCategory.value).subscribe(data => {\n          if (data != 0) {\n            this.router.navigate(['/admin/products/category']);\n          }\n        }, error => {});\n      } else {\n        this.categoryService.updateCategory(this.addCategory.value).subscribe(data => {\n          //this.loading = false;\n          if (data != 0) {\n            //this.ts.showSuccess(\"Success\",\"Record updated successfully.\")\n            this.router.navigate(['/admin/products/category']);\n          }\n        }, error => {// this.ts.showError(\"Error\",\"Failed to update record.\")\n          //this.loading = false;\n        });\n      }\n    }\n\n    ngOnInit() {\n      this.setSelectedCategory();\n      this.ls.getSelectedLocation().id;\n      console.log(this.editForm);\n    }\n\n    get f() {\n      return this.addCategory.controls;\n    }\n\n  }\n\n  AddCategoryComponent.ɵfac = function AddCategoryComponent_Factory(t) {\n    return new (t || AddCategoryComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.LocalStorageService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.CategoryService));\n  };\n\n  AddCategoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddCategoryComponent,\n    selectors: [[\"app-category\"]],\n    viewQuery: function AddCategoryComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(ImageUploadComponent, 7);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.imgComp = _t.first);\n      }\n    },\n    decls: 69,\n    vars: 5,\n    consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"clr-base\", 2, \"padding-top\", \"10px\", \"border-top\", \"outset\"], [1, \"card-body\", \"pl-1\"], [1, \"d-flex\", \"align-items-center\", \"justify-content-between\"], [1, \"d-flex\"], [\"type\", \"button\", 1, \"btn\", \"btn-falcon-default\", \"btn-sm\", \"btn-back\", 3, \"routerLink\"], [\"src\", \"assets/img/icons/arrow-back.png\", \"width\", \"20\", \"height\", \"20\"], [1, \"mb-2\", \"mb-md-0\", \"content-heading\", \"pl-3\"], [\"type\", \"submit\", \"name\", \"submit\", 1, \"btn\", \"btn-primary\", \"me-1\", \"mb-1\", \"btn-save\"], [1, \"row\", \"g-0\", \"clr-base\"], [1, \"col-lg-8\", \"ps-lg-2\", \"pe-lg-2\"], [1, \"card\", \"mb-3\", \"border-radius-4\"], [1, \"card-header\", \"bg-light\", \"p-32\", \"cb-header-border\"], [1, \"mb-0\", \"font-heading\", \"clr-dark\"], [1, \"card-body\", \"p-32\", \"pt-0\"], [1, \"row\", \"gx-2\"], [1, \"col-sm-6\", \"mb-3\"], [\"for\", \"import-status\", 1, \"form-label\", \"clr-dark\", \"fl-mb-12\"], [\"formControlName\", \"name\", \"id\", \"name\", \"type\", \"text\", \"placeholder\", \"English Name\", 1, \"form-control-input\"], [\"formControlName\", \"alternateName\", \"id\", \"alternateName\", \"type\", \"text\", \"placeholder\", \"Arabic Name\", 1, \"form-control-input\"], [1, \"col-12\", \"mb-4\"], [\"for\", \"product-summary\", 1, \"form-label\", \"clr-dark\", \"fl-mb-12\"], [\"formControlName\", \"description\", \"placeholder\", \"e.g. I joined Stripe\\u2019s Customer Success team to help them scale their checkout product. I focused mainly on onboarding new customers and resolving complaints.\", \"id\", \"description\", \"rows\", \"3\", 1, \"form-control\", \"form-control-sm\"], [1, \"col-lg-4\", \"ps-lg-2\", \"pe-lg-2\"], [1, \"sticky-sidebar\", 2, \"position\", \"inherit\"], [1, \"col-12\"], [\"for\", \"status\", 1, \"form-label\", \"fl-mb-12\"], [\"formControlName\", \"statusID\", \"id\", \"statusID\", \"name\", \"statusID\", 1, \"form-select\", \"select-display\"], [\"value\", \"1\"], [\"value\", \"2\"], [\"class\", \"card mb-3 border-radius-4\", 4, \"ngIf\"], [3, \"hidden\"], [\"for\", \"display-order\", 1, \"form-label\", \"clr-dark\", \"fl-mb-12\"], [1, \"input-group\", \"mb-3\"], [\"formControlName\", \"displayOrder\", \"id\", \"displayOrder\", \"type\", \"text\", \"placeholder\", \"Display order\", 1, \"form-control-input\"], [1, \"row\", \"justify-content-between\", \"gx-0\"], [1, \"col-auto\"], [1, \"col-sm-2\"], [1, \"link-del\", 3, \"click\"], [\"data-dropzone\", \"data-dropzone\", \"data-options\", \"{\\\"maxFiles\\\":1,\\\"acceptedFiles\\\":\\\"image/*\\\"}\", 1, \"dropzone\", \"dropzone-single\", \"p-0\", \"dz-clickable\", \"dz-file-processing\", \"dz-file-complete\", \"b-0\", \"dz-txt\", \"px-4\", \"mt-0\"], [1, \"row\", \"justify-content-md-center\", \"pb-4\"], [1, \"col\", \"col-md-4\", \"d-flex\", \"justify-content-center\", \"text-center\"], [1, \"thumbnail\", \"align-text-bottom\", \"text-center\"], [1, \"center-block\", 3, \"src\"]],\n    template: function AddCategoryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function AddCategoryComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"button\", 5);\n        i0.ɵɵelement(6, \"img\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"h5\", 7);\n        i0.ɵɵtext(8, \"Add category\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 4)(10, \"button\", 8);\n        i0.ɵɵtext(11, \"Save\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(12, \"div\", 9)(13, \"div\", 10)(14, \"div\", 11)(15, \"div\", 12);\n        i0.ɵɵelement(16, \"br\");\n        i0.ɵɵelementStart(17, \"h6\", 13);\n        i0.ɵɵtext(18, \"Category Information\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\", 14)(20, \"div\", 15)(21, \"div\", 16)(22, \"label\", 17);\n        i0.ɵɵtext(23, \"English Name \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"input\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 16)(26, \"label\", 17);\n        i0.ɵɵtext(27, \"Arabic Name \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(28, \"input\", 19);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(29, \"div\", 15)(30, \"div\", 20)(31, \"label\", 21);\n        i0.ɵɵtext(32, \"Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"textarea\", 22);\n        i0.ɵɵtext(34, \" \");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(35, \"div\", 23)(36, \"div\", 24)(37, \"div\", 11)(38, \"div\", 12);\n        i0.ɵɵelement(39, \"br\");\n        i0.ɵɵelementStart(40, \"h6\", 13);\n        i0.ɵɵtext(41, \"Category Status\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"div\", 14)(43, \"div\", 15)(44, \"div\", 25)(45, \"label\", 26);\n        i0.ɵɵtext(46, \"Status\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(47, \"select\", 27)(48, \"option\", 28);\n        i0.ɵɵtext(49, \"Active\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"option\", 29);\n        i0.ɵɵtext(51, \"Inactive\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(52, \"div\");\n        i0.ɵɵtemplate(53, AddCategoryComponent_div_53_Template, 15, 1, \"div\", 30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(54, \"div\", 31);\n        i0.ɵɵelement(55, \"app-image-upload\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(56, \"div\", 11)(57, \"div\", 12);\n        i0.ɵɵelement(58, \"br\");\n        i0.ɵɵelementStart(59, \"h6\", 13);\n        i0.ɵɵtext(60, \"Category order\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(61, \"div\", 14)(62, \"div\", 15)(63, \"div\", 25)(64, \"label\", 32);\n        i0.ɵɵtext(65, \"Display order\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(66, \"div\", 33);\n        i0.ɵɵelement(67, \"input\", 34);\n        i0.ɵɵelementEnd()()()()()()()();\n        i0.ɵɵelement(68, \"form\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.addCategory);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c0));\n        i0.ɵɵadvance(48);\n        i0.ɵɵproperty(\"ngIf\", ctx.f.image.value);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", ctx.f.image.value);\n      }\n    },\n    directives: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i3.RouterLink, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i1.SelectControlValueAccessor, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i5.NgIf, i6.ImageUploadComponent, i1.NgForm],\n    styles: [\"\"]\n  });\n  return AddCategoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}